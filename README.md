# VR 5.0 TQQQ 리밸런싱 도우미 (격주)

**라오어 변동성 리밸런싱(VR 5.0) 전략**을 활용한 TQQQ 2주 단위 리밸런싱 웹 애플리케이션입니다.

## 주요 기능

- **실시간 TQQQ 가격 조회**: yfinance를 통한 현재가 자동 조회
- **VR 5.0 계산**: 밴드 기반 매수/매도 판단 자동화
- **액션 제안**: BUY/SELL/HOLD 판단 및 수량/금액 계산
- **로그 관리**: 리밸런싱 이력을 CSV로 저장 및 다운로드
- **일정 관리**: 2주 후 점검 일정을 ICS 파일로 내보내기
- **차트 시각화**: 최근 6개월 TQQQ 종가 추이 확인

## 설치 방법

### 1. 의존성 설치

```bash
pip install -r requirements.txt
```

### 2. 실행

```bash
streamlit run app.py
```

브라우저에서 자동으로 `http://localhost:8501`이 열립니다.

## 프로젝트 구조

```
vr5-bands-app/
├── app.py                  # 메인 애플리케이션
├── utils/
│   ├── vr.py              # VR 5.0 계산 로직
│   └── io.py              # 로그/ICS 파일 관리
├── pages/
│   └── 02_차트.py          # 차트 페이지
├── data/
│   └── vr_log.csv         # 리밸런싱 로그 (자동 생성)
├── requirements.txt       # 의존성
└── README.md             # 문서
```

## 사용법

### 메인 페이지 (리밸런싱 계산)

1. **입력 정보**:
   - 티커: 기본값 `TQQQ`
   - 보유 수량: 현재 보유 주식 수
   - POOL 현금: 보유 현금 (달러)
   - 직전 목표 Value: 이전 리밸런싱 시점의 목표 가치
   - 분모 d: 공격성 조절 파라미터 (기본값: 11)
   - 밴드폭: 리밸런싱 밴드 (기본값: ±0.15 = ±15%)
   - 2주 적립금: 추가 입금 예정 금액 (거치식은 0)

2. **계산하기** 버튼 클릭

3. **결과 확인**:
   - 액션 배지: BUY/SELL/HOLD
   - 현재 평가액, 목표 가치, 밴드 정보
   - 거래 금액 및 수량

4. **로그 저장**: 계산 결과를 CSV에 기록

5. **ICS 다운로드**: 2주 후 점검 일정 파일 다운로드

### 차트 페이지

- 사이드바에서 "02_차트" 페이지로 이동
- 티커 입력 후 "차트 불러오기" 클릭
- 최근 6개월 종가 라인 차트 확인
- 통계 정보 및 최근 30일 데이터 테이블 확인

## VR 5.0 계산 공식

1. **현재 평가액**: `PV = price × shares`
2. **상승률**: `r = 1 + (pool / V_prev) / d`
3. **다음 목표 가치**: `V_next = V_prev × r + contrib`
4. **밴드**:
   - 하단: `low = V_next × (1 - band)`
   - 상단: `high = V_next × (1 + band)`
5. **판단**:
   - `PV < low` → **매수** (`V_next - PV` 만큼)
   - `PV > high` → **매도** (`PV - V_next` 만큼)
   - 밴드 내 → **HOLD**

## 샘플 시나리오

### 테스트 케이스 1 (기본)

- 보유 수량: 500주
- POOL 현금: $10,000
- 직전 목표 Value: $25,000
- 분모 d: 11
- 밴드폭: 0.15
- 2주 적립금: $0

**예상 결과**:
- TQQQ 현재가에 따라 BUY/SELL/HOLD 판단
- 액션 및 수량이 합리적으로 계산됨

### 테스트 케이스 2 (밴드 조정)

- 밴드폭을 0.10으로 변경
- 더 자주 리밸런싱 액션이 발생함

## 주요 파라미터 설명

| 파라미터 | 설명 | 기본값 | 권장 범위 |
|---------|------|--------|----------|
| **d** | 공격성 조절 (높을수록 보수적) | 11 | 8~15 |
| **band** | 리밸런싱 밴드폭 | 0.15 | 0.10~0.20 |
| **contrib** | 격주 적립금 | 0 | 0+ |

## 주의사항

1. **네트워크 연결**: yfinance는 인터넷 연결이 필요합니다
2. **시장 시간**: 시장 마감 후에는 전일 종가가 표시될 수 있습니다
3. **티커 확인**: 올바른 티커 심볼을 입력하세요 (예: TQQQ, QQQ, SPY)
4. **API 제한**: yfinance는 공개 API로 일시적으로 차단될 수 있습니다

## 에러 처리

- **가격 조회 실패**: 네트워크 확인 후 재시도
- **로그 저장 실패**: `data/` 폴더 권한 확인
- **ICS 생성 실패**: 시스템 시간대 설정 확인

## 기술 스택

- **프론트엔드**: Streamlit
- **데이터 조회**: yfinance
- **데이터 처리**: pandas
- **일정 관리**: ics, pytz

## 라이선스

MIT License

## 참고 자료

- [라오어 VR 전략 설명](https://lazyquant.xyz)
- [yfinance 문서](https://pypi.org/project/yfinance/)
- [Streamlit 문서](https://docs.streamlit.io)

## 문의

이슈가 있거나 개선 제안이 있으시면 GitHub Issues를 활용해주세요.

---

**VR 5.0 TQQQ 리밸런싱 도우미** | 2주마다 스마트한 리밸런싱
